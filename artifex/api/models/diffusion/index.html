
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="ARTIFEX - Architectures + Generative + JAX. A production-ready modular generative modeling library built on JAX/Flax, providing implementations of state-of-the-art generative models (VAEs, GANs, Diffusion Models, Flow Models, etc.) with multi-modal support">
      
      
        <meta name="author" content="Mahdi Shafiei">
      
      
        <link rel="canonical" href="https://docs.avitai.bio/artifex/api/models/diffusion/">
      
      
        <link rel="prev" href="../gan/">
      
      
        <link rel="next" href="../flow/">
      
      
        
      
      
      <link rel="icon" href="../../../_static/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Diffusion - Artifex</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_static/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#diffusion-models-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Artifex" class="md-header__button md-logo" aria-label="Artifex" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 19a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1c0-.21-.07-.41-.18-.57L13 8.35V4h-2v4.35L5.18 18.43c-.11.16-.18.36-.18.57m1 3a3 3 0 0 1-3-3c0-.6.18-1.16.5-1.63L9 7.81V6a1 1 0 0 1-1-1V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1v1.81l5.5 9.56c.32.47.5 1.03.5 1.63a3 3 0 0 1-3 3zm7-6 1.34-1.34L16.27 18H7.73l2.66-4.61zm-.5-4a.5.5 0 0 1 .5.5.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5.5.5 0 0 1 .5-.5"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Artifex
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Diffusion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/avitai/artifex" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    avitai/artifex
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Artifex" class="md-nav__button md-logo" aria-label="Artifex" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 19a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1c0-.21-.07-.41-.18-.57L13 8.35V4h-2v4.35L5.18 18.43c-.11.16-.18.36-.18.57m1 3a3 3 0 0 1-3-3c0-.6.18-1.16.5-1.63L9 7.81V6a1 1 0 0 1-1-1V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1v1.81l5.5 9.56c.32.47.5 1.03.5 1.63a3 3 0 0 1-3 3zm7-6 1.34-1.34L16.27 18H7.73l2.66-4.61zm-.5-4a.5.5 0 0 1 .5.5.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5.5.5 0 0 1 .5-.5"/></svg>

    </a>
    Artifex
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/avitai/artifex" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    avitai/artifex
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/hardware-setup-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hardware Setup Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/core-concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/concepts/vae-explained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VAE Explained
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/concepts/gan-explained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GAN Explained
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/concepts/diffusion-explained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion Explained
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/concepts/flow-explained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flow Explained
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/concepts/ebm-explained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EBM Explained
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/concepts/autoregressive-explained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autoregressive Explained
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/models/vae-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VAE Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/models/gan-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GAN Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/models/diffusion-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/models/flow-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flow Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/models/ebm-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EBM Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/models/autoregressive-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autoregressive Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Training
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/training-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/advanced-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging & Experiment Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance Profiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/rl-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/data/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Loading Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/data/data-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Loading Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modalities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modalities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audio Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/multimodal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-modal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Inference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Inference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/inference/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inference Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/inference/sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sampling Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/inference/optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/advanced/distributed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/advanced/parallelism/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Parallelism
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/advanced/checkpointing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Checkpointing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/advanced/architectures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Architectures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/integrations/deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/integrations/huggingface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HuggingFace Hub
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/integrations/wandb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weights & Biases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/integrations/tensorboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TensorBoard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/losses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loss Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/device-manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Device Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sampling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vae/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VAE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Diffusion
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#base-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Base Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diffusionmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiffusionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DiffusionModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DiffusionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.backbone" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;backbone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.noise_schedule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;noise_schedule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.betas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;betas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod_prev" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas_cumprod_prev
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_one_minus_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_one_minus_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.log_one_minus_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;log_one_minus_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recip_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_recip_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recipm1_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_recipm1_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_variance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_variance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_log_variance_clipped" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_log_variance_clipped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_mean_coef1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef2" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_mean_coef2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.q_sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;q_sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.predict_start_from_noise" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;predict_start_from_noise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.q_posterior_mean_variance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;q_posterior_mean_variance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.p_mean_variance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;p_mean_variance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.p_sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;p_sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.generate" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;loss_fn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â loss_fn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpm-denoising-diffusion-probabilistic-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDPM (Denoising Diffusion Probabilistic Models)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DDPM (Denoising Diffusion Probabilistic Models)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ddpmmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDPMModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DDPMModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DDPMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.loss_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loss_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.clip_denoised" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;clip_denoised
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.in_channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;in_channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.noise_steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;noise_steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_start" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;beta_start
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_end" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;beta_end
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_schedule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;beta_schedule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.forward_diffusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward_diffusion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.denoise_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;denoise_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddim-denoising-diffusion-implicit-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDIM (Denoising Diffusion Implicit Models)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DDIM (Denoising Diffusion Implicit Models)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ddimmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDIMModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DDIMModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DDIMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.eta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ddim_steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.skip_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;skip_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.get_ddim_timesteps" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_ddim_timesteps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ddim_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ddim_sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_reverse" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ddim_reverse
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ddim_reverse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#score-based-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Score-Based Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Score-Based Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scorediffusionmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        ScoreDiffusionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ScoreDiffusionModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ScoreDiffusionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_min" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sigma_min
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_max" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sigma_max
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score_scaling" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;score_scaling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;loss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.denoise" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;denoise
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â denoise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#latent-diffusion-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Latent Diffusion Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Latent Diffusion Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ldmmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        LDMModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LDMModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â LDMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.original_input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;original_input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.latent_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;latent_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.scale_factor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;scale_factor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;encoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;decoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.use_pretrained_vae" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;use_pretrained_vae
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.output_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;output_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.encode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;encode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.decode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.reparameterize" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reparameterize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.denoise" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;denoise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;loss
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â loss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diffusion-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diffusion Transformers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Diffusion Transformers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ditmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiTModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DiTModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DiTModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.num_classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;num_classes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.cfg_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cfg_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.learn_sigma" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;learn_sigma
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.in_channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;in_channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.img_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;img_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.noise_schedule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;noise_schedule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.betas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;betas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.alphas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.backbone" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;backbone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.sample_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.generate" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â generate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guidance-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guidance Techniques
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guidance Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classifierfreeguidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClassifierFreeGuidance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassifierFreeGuidance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ClassifierFreeGuidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.unconditional_conditioning" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unconditional_conditioning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â unconditional_conditioning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classifierguidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClassifierGuidance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassifierGuidance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ClassifierGuidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.classifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;classifier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.class_label" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;class_label
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â class_label">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guideddiffusionmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        GuidedDiffusionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GuidedDiffusionModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â GuidedDiffusionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_method" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_method
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guided_sample_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;guided_sample_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.generate" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â generate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guidance-utility-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guidance Utility Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guidance Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apply_guidancenoise_pred_cond-noise_pred_uncond-guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_guidance(noise_pred_cond, noise_pred_uncond, guidance_scale)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linear_guidance_schedulestep-total_steps-start_scale10-end_scale75" class="md-nav__link">
    <span class="md-ellipsis">
      
        linear_guidance_schedule(step, total_steps, start_scale=1.0, end_scale=7.5)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cosine_guidance_schedulestep-total_steps-start_scale10-end_scale75" class="md-nav__link">
    <span class="md-ellipsis">
      
        cosine_guidance_schedule(step, total_steps, start_scale=1.0, end_scale=7.5)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxiliary-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auxiliary Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Auxiliary Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simpleencoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleEncoder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SimpleEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â SimpleEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.latent_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;latent_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.hidden_dims" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hidden_dims
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.is_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.flat_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flat_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;layers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.mean_layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;mean_layer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.logvar_layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logvar_layer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â logvar_layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simpledecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleDecoder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SimpleDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â SimpleDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.latent_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;latent_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;output_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.hidden_dims" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hidden_dims
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.is_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.flat_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flat_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;layers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;output_layer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â output_layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modelconfig-for-diffusion-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelConfig for Diffusion Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelConfig for Diffusion Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddpm-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDPM Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddim-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDIM Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#score-based-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Score-Based Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#latent-diffusion-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Latent Diffusion Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dit-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiT Parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-selection-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model Selection Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-usage-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Usage Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../autoregressive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autoregressive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ebm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Energy-Based
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Training
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../training/trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trainer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Model-Specific Trainers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Model-Specific Trainers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/vae_trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VAE Trainer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/gan_trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GAN Trainer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/diffusion_trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion Trainer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/flow_trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flow Trainer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    RL Trainers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    RL Trainers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/reinforce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REINFORCE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/ppo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/grpo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GRPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/dpo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DPO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_4" >
        
          
          <label class="md-nav__link" for="__nav_4_3_4" id="__nav_4_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Callbacks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Callbacks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Profiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/checkpoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Checkpointing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/early_stopping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Early Stopping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_5" >
        
          
          <label class="md-nav__link" for="__nav_4_3_5" id="__nav_4_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Distributed
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Distributed
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/mesh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Device Mesh
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/data_parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Parallel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/device_placement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Device Placement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/distributed_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../training/model_parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Parallel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/loaders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Loaders
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Diffusion Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Diffusion Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/diffusion/simple-diffusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Diffusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/diffusion/dit-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DiT Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Energy-Based Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Energy-Based Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/energy/simple-ebm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple EBM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Basic Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Basic Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/vae-mnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VAE on MNIST
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/simple-gan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple GAN (2D)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/diffusion-mnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion on MNIST
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/diffusion-mnist-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion MNIST Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/flow-mnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flow on MNIST
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/ebm-mnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EBM on MNIST
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/ar-text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autoregressive Text
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/basic/transformer-text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformer Text
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/advanced-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/advanced-vae/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced VAE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/advanced-gan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced GAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/advanced-diffusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Diffusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/advanced-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/clip-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLIP Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/visual-qa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual QA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/image-captioning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image Captioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/cross-modal-retrieval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cross-Modal Retrieval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/text-compression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Compression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/seq2seq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Seq2Seq Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/advanced/multimodal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multimodal Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    VAE Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    VAE Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/vae/multi-beta-vae-benchmark-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Beta VAE Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Protein Modeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Protein Modeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-diffusion-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Diffusion Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-diffusion-tech-validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Diffusion Tech Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-extensions-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Extensions Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-model-extension/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Model Extension
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-model-with-modality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Model with Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-point-cloud-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Point Cloud Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-extensions-with-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Extensions with Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/protein/protein-ligand-benchmark-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Ligand Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Geometric Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Geometric Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/geometric/geometric-models-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometric Models Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/geometric/geometric-losses-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometric Losses Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/geometric/simple-point-cloud-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Point Cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/geometric/geometric-benchmark-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometric Benchmark Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_9" >
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Audio Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Audio Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/audio/simple-audio-generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Audio Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Text Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Text Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/text/simple-text-generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Text Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_11" >
        
          
          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Multimodal Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Multimodal Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/multimodal/simple-image-text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Image-Text
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Framework Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Framework Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/framework/framework-features-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Framework Features Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/framework/training-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/framework/model-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          <label class="md-nav__link" for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Loss Functions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Loss Functions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/losses/loss-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loss Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_14" >
        
          
          <label class="md-nav__link" for="__nav_5_14" id="__nav_5_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Sampling Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sampling Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/sampling/blackjax-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BlackJAX Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/sampling/blackjax-sampling-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BlackJAX Sampling Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/sampling/blackjax-integration-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BlackJAX Integration Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    All Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Generative Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Generative Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../zoo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Zoo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Implementations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../factory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Factories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Training
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/training-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/advanced-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging & Experiment Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance Profiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/training/rl-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RL Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../training/trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trainer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fine_tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fine-Tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data & Modalities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data & Modalities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/data/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Loading Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/data/data-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Loading Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audio Modality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/modalities/multimodal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-modal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data/loaders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Loaders
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Inference & Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Inference & Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/inference/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inference Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/inference/sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sampling Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user-guide/inference/optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/factory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Factory Pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/modalities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modalities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/custom-extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/protein-modeling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/protein-extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Protein Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/geometric-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometric Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/point-clouds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Point Clouds
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Topics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Topics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/losses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loss Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command Line Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/blackjax-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BlackJAX Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/philosophy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development Philosophy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Community
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Community
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#base-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Base Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diffusionmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiffusionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DiffusionModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DiffusionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.backbone" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;backbone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.noise_schedule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;noise_schedule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.betas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;betas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod_prev" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas_cumprod_prev
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_one_minus_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_one_minus_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.log_one_minus_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;log_one_minus_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recip_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_recip_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recipm1_alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sqrt_recipm1_alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_variance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_variance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_log_variance_clipped" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_log_variance_clipped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_mean_coef1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef2" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;posterior_mean_coef2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.q_sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;q_sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.predict_start_from_noise" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;predict_start_from_noise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.q_posterior_mean_variance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;q_posterior_mean_variance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.p_mean_variance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;p_mean_variance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.p_sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;p_sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.generate" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.loss_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;loss_fn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â loss_fn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpm-denoising-diffusion-probabilistic-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDPM (Denoising Diffusion Probabilistic Models)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DDPM (Denoising Diffusion Probabilistic Models)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ddpmmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDPMModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DDPMModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DDPMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.loss_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loss_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.clip_denoised" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;clip_denoised
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.in_channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;in_channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.noise_steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;noise_steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_start" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;beta_start
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_end" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;beta_end
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_schedule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;beta_schedule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.forward_diffusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;forward_diffusion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.denoise_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;denoise_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddim-denoising-diffusion-implicit-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDIM (Denoising Diffusion Implicit Models)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DDIM (Denoising Diffusion Implicit Models)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ddimmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDIMModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DDIMModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DDIMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.eta" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;eta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ddim_steps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.skip_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;skip_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.get_ddim_timesteps" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_ddim_timesteps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ddim_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ddim_sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_reverse" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ddim_reverse
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ddim_reverse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#score-based-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Score-Based Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Score-Based Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scorediffusionmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        ScoreDiffusionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ScoreDiffusionModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ScoreDiffusionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_min" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sigma_min
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_max" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;sigma_max
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score_scaling" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;score_scaling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;loss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.denoise" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;denoise
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â denoise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#latent-diffusion-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Latent Diffusion Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Latent Diffusion Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ldmmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        LDMModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LDMModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â LDMModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.original_input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;original_input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.latent_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;latent_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.scale_factor" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;scale_factor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;encoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;decoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.use_pretrained_vae" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;use_pretrained_vae
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.output_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;output_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.encode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;encode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.decode" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.reparameterize" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reparameterize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.denoise" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;denoise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.LDMModel.loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;loss
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â loss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diffusion-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diffusion Transformers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Diffusion Transformers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ditmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiTModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DiTModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â DiTModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.num_classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;num_classes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.cfg_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cfg_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.learn_sigma" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;learn_sigma
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.in_channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;in_channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.img_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;img_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.noise_schedule" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;noise_schedule
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.betas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;betas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.alphas" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.alphas_cumprod" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;alphas_cumprod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.backbone" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;backbone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.sample_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sample_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.dit.DiTModel.generate" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â generate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guidance-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guidance Techniques
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guidance Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classifierfreeguidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClassifierFreeGuidance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassifierFreeGuidance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ClassifierFreeGuidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.unconditional_conditioning" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;unconditional_conditioning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â unconditional_conditioning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classifierguidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClassifierGuidance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassifierGuidance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â ClassifierGuidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.classifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;classifier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.class_label" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;class_label
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â class_label">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guideddiffusionmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        GuidedDiffusionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GuidedDiffusionModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â GuidedDiffusionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_method" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_method
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance_scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;guidance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guided_sample_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;guided_sample_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.generate" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â generate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guidance-utility-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guidance Utility Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Guidance Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apply_guidancenoise_pred_cond-noise_pred_uncond-guidance_scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_guidance(noise_pred_cond, noise_pred_uncond, guidance_scale)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linear_guidance_schedulestep-total_steps-start_scale10-end_scale75" class="md-nav__link">
    <span class="md-ellipsis">
      
        linear_guidance_schedule(step, total_steps, start_scale=1.0, end_scale=7.5)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cosine_guidance_schedulestep-total_steps-start_scale10-end_scale75" class="md-nav__link">
    <span class="md-ellipsis">
      
        cosine_guidance_schedule(step, total_steps, start_scale=1.0, end_scale=7.5)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxiliary-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auxiliary Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Auxiliary Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simpleencoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleEncoder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SimpleEncoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â SimpleEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.input_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;input_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.latent_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;latent_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.hidden_dims" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hidden_dims
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.is_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.flat_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flat_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;layers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.mean_layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;mean_layer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.logvar_layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logvar_layer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â logvar_layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simpledecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleDecoder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SimpleDecoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â SimpleDecoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.latent_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;latent_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;output_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.hidden_dims" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hidden_dims
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.is_image" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_image
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.flat_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;flat_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;layers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;output_layer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â output_layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modelconfig-for-diffusion-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelConfig for Diffusion Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelConfig for Diffusion Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddpm-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDPM Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddim-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        DDIM Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#score-based-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Score-Based Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#latent-diffusion-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Latent Diffusion Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dit-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiT Parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-selection-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model Selection Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-usage-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Usage Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="../../core/base/" class="md-path__link">
          
  <span class="md-ellipsis">
    API Reference
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../vae/" class="md-path__link">
          
  <span class="md-ellipsis">
    Models
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="diffusion-models-api-reference">Diffusion Models API Reference<a class="headerlink" href="#diffusion-models-api-reference" title="Permanent link">Â¤</a></h1>
<p>Complete API documentation for all diffusion model classes in Artifex.</p>
<h2 id="base-classes">Base Classes<a class="headerlink" href="#base-classes" title="Permanent link">Â¤</a></h2>
<h3 id="diffusionmodel">DiffusionModel<a class="headerlink" href="#diffusionmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.base.DiffusionModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.base.DiffusionModel</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">DiffusionModel</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.configuration.DiffusionConfig">DiffusionConfig</span></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="artifex.generative_models.core.base.GenerativeModel">GenerativeModel</span></code></p>



        <p>Base class for diffusion models.</p>
<p>This implements a general diffusion model that can support various diffusion
processes like DDPM (Denoising Diffusion Probabilistic Models) and
DDIM (Denoising Diffusion Implicit Models).</p>
<p>Uses the nested DiffusionConfig architecture with:
- backbone: BackboneConfig (polymorphic) for the denoising network
- noise_schedule: NoiseScheduleConfig for the diffusion schedule</p>
<p>Backbone type is determined by config.backbone.backbone_type discriminator.
Supported backbones: UNet, DiT, U-ViT, UNet2DCondition.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;config&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;artifex.generative_models.models.diffusion.base.DiffusionModel.config&lt;/code&gt;)" href="#artifex.generative_models.models.diffusion.base.DiffusionModel.config">config</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DiffusionConfig for the model</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;backbone&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;artifex.generative_models.models.diffusion.base.DiffusionModel.backbone&lt;/code&gt;)" href="#artifex.generative_models.models.diffusion.base.DiffusionModel.backbone">backbone</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The denoising network (created from config.backbone)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-attribute&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;noise_schedule&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-instance-attribute&quot;&gt;&lt;code&gt;instance-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;artifex.generative_models.models.diffusion.base.DiffusionModel.noise_schedule&lt;/code&gt;)" href="#artifex.generative_models.models.diffusion.base.DiffusionModel.noise_schedule">noise_schedule</a></code></td>
            <td>
                  <code><span title="artifex.generative_models.core.noise_schedule.NoiseSchedule">NoiseSchedule</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NoiseSchedule instance for diffusion process</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="artifex.generative_models.core.configuration.DiffusionConfig">DiffusionConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DiffusionConfig with nested backbone and noise_schedule configs.
    The backbone field accepts any BackboneConfig type (UNetBackboneConfig,
    DiTBackboneConfig, etc.) and the appropriate backbone is created
    based on the backbone_type discriminator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">config</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.config" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">config</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(config)">config</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.backbone" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">backbone</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.backbone" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">backbone</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.core.configuration.backbone_config.create_backbone">create_backbone</span></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(config).backbone">backbone</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.core.configuration.backbone_config.create_backbone(rngs)">rngs</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.noise_schedule" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">noise_schedule</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.noise_schedule" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">noise_schedule</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.noise_schedule.NoiseSchedule">NoiseSchedule</span></span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.core.noise_schedule.create_noise_schedule">create_noise_schedule</span></span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(config).noise_schedule">noise_schedule</span></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.betas" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">betas</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.betas" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">betas</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.betas">betas</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.alphas" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">alphas</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">alphas</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.alphas">alphas</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">alphas_cumprod</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.alphas_cumprod">alphas_cumprod</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod_prev" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">alphas_cumprod_prev</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.alphas_cumprod_prev" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">alphas_cumprod_prev</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.alphas_cumprod_prev">alphas_cumprod_prev</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sqrt_alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sqrt_alphas_cumprod</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.sqrt_alphas_cumprod">sqrt_alphas_cumprod</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_one_minus_alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sqrt_one_minus_alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_one_minus_alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sqrt_one_minus_alphas_cumprod</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.sqrt_one_minus_alphas_cumprod">sqrt_one_minus_alphas_cumprod</span></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.log_one_minus_alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">log_one_minus_alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.log_one_minus_alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">log_one_minus_alphas_cumprod</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.log_one_minus_alphas_cumprod">log_one_minus_alphas_cumprod</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recip_alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sqrt_recip_alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recip_alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sqrt_recip_alphas_cumprod</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.sqrt_recip_alphas_cumprod">sqrt_recip_alphas_cumprod</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recipm1_alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sqrt_recipm1_alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.sqrt_recipm1_alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sqrt_recipm1_alphas_cumprod</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.sqrt_recipm1_alphas_cumprod">sqrt_recipm1_alphas_cumprod</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_variance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">posterior_variance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_variance" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">posterior_variance</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.posterior_variance">posterior_variance</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_log_variance_clipped" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">posterior_log_variance_clipped</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_log_variance_clipped" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">posterior_log_variance_clipped</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.posterior_log_variance_clipped">posterior_log_variance_clipped</span></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef1" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">posterior_mean_coef1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef1" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">posterior_mean_coef1</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.posterior_mean_coef1">posterior_mean_coef1</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">posterior_mean_coef2</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.posterior_mean_coef2" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">posterior_mean_coef2</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.base.DiffusionModel(self).noise_schedule.posterior_mean_coef2">posterior_mean_coef2</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.q_sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">q_sample</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.q_sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">q_sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x_start</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample from the forward diffusion process q(x_t | x_0).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_start</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting clean data (x_0)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>noise</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional pre-generated noise</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy samples x_t</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.predict_start_from_noise" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">predict_start_from_noise</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.predict_start_from_noise" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">predict_start_from_noise</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Predict x_0 from noise model output.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy input at timestep t</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>noise</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted noise</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted x_0</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.q_posterior_mean_variance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">q_posterior_mean_variance</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.q_posterior_mean_variance" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">q_posterior_mean_variance</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x_start</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the mean and variance of the diffusion posterior q(x_{t-1} | x_t, x_0).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_start</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clean data (x_0)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy data (x_t)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (posterior_mean, posterior_variance, posterior_log_variance_clipped)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.p_mean_variance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">p_mean_variance</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.p_mean_variance" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">p_mean_variance</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">model_output</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">clip_denoised</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the model's predicted mean and variance for x_{t-1}.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_output</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted noise or x_0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy input at timestep t</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_denoised</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to clip the denoised signal to [-1, 1]</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with predicted mean and variance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.p_sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">p_sample</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.p_sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">p_sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">model_output</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">clip_denoised</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample from the denoising process p(x_{t-1} | x_t).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_output</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted noise</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy input at timestep t</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_denoised</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to clip the denoised signal to [-1, 1]</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoised x_{t-1}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.generate" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">generate</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">n_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">clip_denoised</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate samples from random noise.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, ...] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of samples to generate (excluding batch dimension)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_denoised</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to clip the denoised signal to [-1, 1]</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.base.DiffusionModel.loss_fn" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">loss_fn</span>


<a href="#artifex.generative_models.models.diffusion.base.DiffusionModel.loss_fn" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">loss_fn</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">batch</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">,</span> <span class="n">model_outputs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute loss for training.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input batch (should contain 'x' key with data)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_outputs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model outputs from forward pass</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing loss and metrics</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>Base class for all diffusion models, implementing the core diffusion process.</p>
<p><strong>Purpose</strong>: Provides the foundational diffusion framework including forward diffusion (adding noise), reverse diffusion (denoising), and noise scheduling.</p>
<h4 id="initialization">Initialization<a class="headerlink" href="#initialization" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DiffusionModel</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">backbone_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>config</code></td>
<td><code>ModelConfig</code></td>
<td>Model configuration with input dimensions and parameters</td>
</tr>
<tr>
<td><code>backbone_fn</code></td>
<td><code>Callable</code></td>
<td>Function that creates the backbone network (e.g., U-Net)</td>
</tr>
<tr>
<td><code>rngs</code></td>
<td><code>nnx.Rngs</code></td>
<td>Random number generators for initialization</td>
</tr>
</tbody>
</table>
<p><strong>Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>noise_steps</code></td>
<td><code>int</code></td>
<td>1000</td>
<td>Number of diffusion timesteps</td>
</tr>
<tr>
<td><code>beta_start</code></td>
<td><code>float</code></td>
<td>1e-4</td>
<td>Initial noise variance</td>
</tr>
<tr>
<td><code>beta_end</code></td>
<td><code>float</code></td>
<td>0.02</td>
<td>Final noise variance</td>
</tr>
</tbody>
</table>
<h4 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">Â¤</a></h4>
<h5 id="__call__x-timesteps-rngsnone-trainingfalse-kwargs"><code>__call__(x, timesteps, *, rngs=None, training=False, **kwargs)</code><a class="headerlink" href="#__call__x-timesteps-rngsnone-trainingfalse-kwargs" title="Permanent link">Â¤</a></h5>
<p>Forward pass through the diffusion model.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x</code> (<code>jax.Array</code>): Input data <code>(batch, *input_dim)</code></li>
<li><code>timesteps</code> (<code>jax.Array</code>): Timestep indices <code>(batch,)</code></li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>training</code> (<code>bool</code>): Whether in training mode</li>
<li><code>**kwargs</code>: Additional arguments passed to backbone</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>dict[str, Any]</code>: Dictionary containing <code>"predicted_noise"</code> and potentially other outputs</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Create model</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DiffusionModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">backbone_fn</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Forward pass</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;predicted_noise&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (4, 32, 32, 3)</span>
</span></code></pre></div>
<h5 id="setup_noise_schedule"><code>setup_noise_schedule()</code><a class="headerlink" href="#setup_noise_schedule" title="Permanent link">Â¤</a></h5>
<p>Set up the noise schedule for the diffusion process.</p>
<p><strong>Description:</strong></p>
<p>Computes the noise schedule (betas) and derived quantities (alphas, alpha_cumprod, etc.) used throughout the diffusion process. Default implementation uses a linear schedule.</p>
<p><strong>Computed Attributes:</strong></p>
<ul>
<li><code>betas</code>: Noise variances at each timestep</li>
<li><code>alphas</code>: <span class="arithmatex">\(\alpha_t = 1 - \beta_t\)</span></li>
<li><code>alphas_cumprod</code>: <span class="arithmatex">\(\bar{\alpha}_t = \prod_{i=1}^t \alpha_i\)</span></li>
<li><code>sqrt_alphas_cumprod</code>: <span class="arithmatex">\(\sqrt{\bar{\alpha}_t}\)</span></li>
<li><code>sqrt_one_minus_alphas_cumprod</code>: <span class="arithmatex">\(\sqrt{1 - \bar{\alpha}_t}\)</span></li>
<li><code>posterior_variance</code>: Variance of <span class="arithmatex">\(q(x_{t-1} | x_t, x_0)\)</span></li>
</ul>
<h5 id="q_samplex_start-t-noisenone-rngsnone"><code>q_sample(x_start, t, noise=None, *, rngs=None)</code><a class="headerlink" href="#q_samplex_start-t-noisenone-rngsnone" title="Permanent link">Â¤</a></h5>
<p>Sample from the forward diffusion process <span class="arithmatex">\(q(x_t | x_0)\)</span>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x_start</code> (<code>jax.Array</code>): Clean data <span class="arithmatex">\(x_0\)</span></li>
<li><code>t</code> (<code>jax.Array</code>): Timesteps <code>(batch,)</code></li>
<li><code>noise</code> (<code>jax.Array | None</code>): Optional pre-generated noise</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Noisy samples <span class="arithmatex">\(x_t\)</span></li>
</ul>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
x_t = \sqrt{\bar{\alpha}_t} x_0 + \sqrt{1 - \bar{\alpha}_t} \epsilon, \quad \epsilon \sim \mathcal{N}(0, I)
\]</div>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Add noise to clean images</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">x_clean</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">x_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">q_sample</span><span class="p">(</span><span class="n">x_clean</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clean: </span><span class="si">{</span><span class="n">x_clean</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, Noisy: </span><span class="si">{</span><span class="n">x_noisy</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="p_samplemodel_output-x_t-t-rngsnone-clip_denoisedtrue"><code>p_sample(model_output, x_t, t, *, rngs=None, clip_denoised=True)</code><a class="headerlink" href="#p_samplemodel_output-x_t-t-rngsnone-clip_denoisedtrue" title="Permanent link">Â¤</a></h5>
<p>Sample from the denoising process <span class="arithmatex">\(p(x_{t-1} | x_t)\)</span>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>model_output</code> (<code>jax.Array</code>): Predicted noise from model</li>
<li><code>x_t</code> (<code>jax.Array</code>): Noisy input at timestep <span class="arithmatex">\(t\)</span></li>
<li><code>t</code> (<code>jax.Array</code>): Current timesteps</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>clip_denoised</code> (<code>bool</code>): Whether to clip to [-1, 1]</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Denoised sample <span class="arithmatex">\(x_{t-1}\)</span></li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Single denoising step</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">x_t</span> <span class="o">=</span> <span class="n">noisy_sample</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">500</span><span class="p">])</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1"># Get model prediction</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">predicted_noise</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="s2">&quot;predicted_noise&quot;</span><span class="p">]</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1"># Denoise one step</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="n">x_t_minus_1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">p_sample</span><span class="p">(</span><span class="n">predicted_noise</span><span class="p">,</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="generaten_samples1-rngsnone-shapenone-clip_denoisedtrue-kwargs"><code>generate(n_samples=1, *, rngs=None, shape=None, clip_denoised=True, **kwargs)</code><a class="headerlink" href="#generaten_samples1-rngsnone-shapenone-clip_denoisedtrue-kwargs" title="Permanent link">Â¤</a></h5>
<p>Generate samples from random noise.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>n_samples</code> (<code>int</code>): Number of samples to generate</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>shape</code> (<code>tuple[int, ...] | None</code>): Sample shape (excluding batch)</li>
<li><code>clip_denoised</code> (<code>bool</code>): Whether to clip to [-1, 1]</li>
<li><code>**kwargs</code>: Additional model arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Generated samples <code>(n_samples, *shape)</code></li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Generate 16 samples</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated: </span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (16, 32, 32, 3)</span>
</span></code></pre></div>
<h5 id="predict_start_from_noisex_t-t-noise"><code>predict_start_from_noise(x_t, t, noise)</code><a class="headerlink" href="#predict_start_from_noisex_t-t-noise" title="Permanent link">Â¤</a></h5>
<p>Predict <span class="arithmatex">\(x_0\)</span> from <span class="arithmatex">\(x_t\)</span> and predicted noise.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x_t</code> (<code>jax.Array</code>): Noisy sample at timestep <span class="arithmatex">\(t\)</span></li>
<li><code>t</code> (<code>jax.Array</code>): Timesteps</li>
<li><code>noise</code> (<code>jax.Array</code>): Predicted noise</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Predicted <span class="arithmatex">\(x_0\)</span></li>
</ul>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
x_0 = \frac{1}{\sqrt{\bar{\alpha}_t}} x_t - \frac{\sqrt{1 - \bar{\alpha}_t}}{\sqrt{\bar{\alpha}_t}} \epsilon
\]</div>
<h5 id="loss_fnbatch-model_outputs-rngsnone-kwargs"><code>loss_fn(batch, model_outputs, *, rngs=None, **kwargs)</code><a class="headerlink" href="#loss_fnbatch-model_outputs-rngsnone-kwargs" title="Permanent link">Â¤</a></h5>
<p>Compute the diffusion loss.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>batch</code> (<code>Any</code>): Input batch (dict with <code>'x'</code> key or array)</li>
<li><code>model_outputs</code> (<code>dict[str, Any]</code>): Model predictions</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>**kwargs</code>: Additional arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>dict[str, Any]</code>: Dictionary with <code>'loss'</code> and metrics</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Training loop</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nd">@nnx</span><span class="o">.</span><span class="n">jit</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">train_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">rngs</span><span class="p">):</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn_wrapper</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>        <span class="c1"># Add noise</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">timestep</span><span class="p">(),</span> <span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">noise</span><span class="p">(),</span> <span class="n">batch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>        <span class="n">x_noisy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">q_sample</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        <span class="c1"># Predict</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_noisy</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        <span class="c1"># Compute loss</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        <span class="n">loss_dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">batch</span><span class="p">},</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>        <span class="k">return</span> <span class="n">loss_dict</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="n">loss</span><span class="p">,</span> <span class="n">grads</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss_fn_wrapper</span><span class="p">)(</span><span class="n">model</span><span class="p">)</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">grads</span><span class="p">)</span>  <span class="c1"># NNX 0.11.0+ API</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="ddpm-denoising-diffusion-probabilistic-models">DDPM (Denoising Diffusion Probabilistic Models)<a class="headerlink" href="#ddpm-denoising-diffusion-probabilistic-models" title="Permanent link">Â¤</a></h2>
<h3 id="ddpmmodel">DDPMModel<a class="headerlink" href="#ddpmmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.ddpm.DDPMModel</span>


<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">DDPMModel</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.configuration.DDPMConfig">DDPMConfig</span></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.diffusion.base.DiffusionModel&lt;/span&gt;" href="#artifex.generative_models.models.diffusion.base.DiffusionModel">DiffusionModel</a></code></p>



        <p>DDPM (Denoising Diffusion Probabilistic Models) implementation.</p>
<p>This model implements the denoising diffusion probabilistic model
as described in the DDPM paper by Ho et al.</p>
<p>Uses nested DDPMConfig with:
- backbone: BackboneConfig (polymorphic) for the denoising network
- noise_schedule: NoiseScheduleConfig for the diffusion schedule
- loss_type: Loss function type (mse, l1, huber)
- clip_denoised: Whether to clip denoised samples</p>
<p>Backbone type is determined by config.backbone.backbone_type discriminator.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="artifex.generative_models.core.configuration.DDPMConfig">DDPMConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DDPMConfig with nested backbone and noise_schedule configs.
    The backbone field accepts any BackboneConfig type and the
    appropriate backbone is created based on backbone_type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.loss_type" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">loss_type</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.loss_type" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">loss_type</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).loss_type">loss_type</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.clip_denoised" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">clip_denoised</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.clip_denoised" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">clip_denoised</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).clip_denoised">clip_denoised</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.input_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">input_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.input_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).input_shape">input_shape</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.in_channels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">in_channels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.in_channels" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">in_channels</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).input_shape">input_shape</span></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.noise_steps" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">noise_steps</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.noise_steps" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">noise_steps</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).noise_schedule.num_timesteps">num_timesteps</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_start" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">beta_start</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_start" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">beta_start</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).noise_schedule.beta_start">beta_start</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_end" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">beta_end</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_end" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">beta_end</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).noise_schedule.beta_end">beta_end</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_schedule" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">beta_schedule</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.beta_schedule" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">beta_schedule</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddpm.DDPMModel(config).noise_schedule.schedule_type">schedule_type</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.forward_diffusion" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">forward_diffusion</span>


<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.forward_diffusion" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward_diffusion</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward diffusion process q(x_t | x_0).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestep indices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (noisy_x, noise)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.denoise_step" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">denoise_step</span>


<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.denoise_step" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">denoise_step</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">predicted_noise</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">clip_denoised</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform a single denoising step: x_{t-1} = f(x_t, t, noise).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy input at timestep t</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current timestep indices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>predicted_noise</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted noise from the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_denoised</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to clip values to [-1, 1]</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoised x_{t-1}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddpm.DDPMModel.sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample</span>


<a href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel.sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">n_samples_or_shape</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">scheduler</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;ddpm&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample from the diffusion model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples_or_shape</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples or full shape including batch dimension</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scheduler</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sampling scheduler to use ('ddpm', 'ddim')</p>
              </div>
            </td>
            <td>
                  <code>&#39;ddpm&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of sampling steps (if None, use default)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>Standard DDPM implementation with support for both DDPM and DDIM sampling.</p>
<p><strong>Purpose</strong>: Implements the foundational denoising diffusion probabilistic model with standard training and sampling procedures.</p>
<h4 id="initialization_1">Initialization<a class="headerlink" href="#initialization_1" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">DDPMModel</span><span class="p">(</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">,</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>config</code></td>
<td><code>ModelConfig</code></td>
<td>Model configuration</td>
</tr>
<tr>
<td><code>rngs</code></td>
<td><code>nnx.Rngs</code></td>
<td>Random number generators</td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td><code>dict</code></td>
<td>Additional arguments (e.g., <code>backbone_fn</code>)</td>
</tr>
</tbody>
</table>
<p><strong>Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>noise_steps</code></td>
<td><code>int</code></td>
<td>1000</td>
<td>Number of diffusion timesteps</td>
</tr>
<tr>
<td><code>beta_start</code></td>
<td><code>float</code></td>
<td>1e-4</td>
<td>Initial noise variance</td>
</tr>
<tr>
<td><code>beta_end</code></td>
<td><code>float</code></td>
<td>0.02</td>
<td>Final noise variance</td>
</tr>
<tr>
<td><code>beta_schedule</code></td>
<td><code>str</code></td>
<td>"linear"</td>
<td>Schedule type ("linear" or "cosine")</td>
</tr>
</tbody>
</table>
<h4 id="methods_1">Methods<a class="headerlink" href="#methods_1" title="Permanent link">Â¤</a></h4>
<h5 id="forward_diffusionx-t-rngsnone"><code>forward_diffusion(x, t, *, rngs=None)</code><a class="headerlink" href="#forward_diffusionx-t-rngsnone" title="Permanent link">Â¤</a></h5>
<p>Forward diffusion process <span class="arithmatex">\(q(x_t | x_0)\)</span>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x</code> (<code>jax.Array</code>): Clean input data</li>
<li><code>t</code> (<code>jax.Array</code>): Timestep indices</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>tuple[jax.Array, jax.Array]</code>: <code>(noisy_x, noise)</code> tuple</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DDPMModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">x_clean</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">x_noisy</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forward_diffusion</span><span class="p">(</span><span class="n">x_clean</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="denoise_stepx_t-t-predicted_noise-clip_denoisedtrue"><code>denoise_step(x_t, t, predicted_noise, clip_denoised=True)</code><a class="headerlink" href="#denoise_stepx_t-t-predicted_noise-clip_denoisedtrue" title="Permanent link">Â¤</a></h5>
<p>Single denoising step.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x_t</code> (<code>jax.Array</code>): Noisy input at timestep <span class="arithmatex">\(t\)</span></li>
<li><code>t</code> (<code>jax.Array</code>): Current timesteps</li>
<li><code>predicted_noise</code> (<code>jax.Array</code>): Predicted noise</li>
<li><code>clip_denoised</code> (<code>bool</code>): Whether to clip to [-1, 1]</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Denoised <span class="arithmatex">\(x_{t-1}\)</span></li>
</ul>
<h5 id="samplen_samples_or_shape-schedulerddpm-stepsnone-rngsnone-kwargs"><code>sample(n_samples_or_shape, scheduler="ddpm", steps=None, *, rngs=None, **kwargs)</code><a class="headerlink" href="#samplen_samples_or_shape-schedulerddpm-stepsnone-rngsnone-kwargs" title="Permanent link">Â¤</a></h5>
<p>Sample from the diffusion model.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>n_samples_or_shape</code> (<code>int | tuple</code>): Number of samples or full shape</li>
<li><code>scheduler</code> (<code>str</code>): Sampling scheduler (<code>"ddpm"</code> or <code>"ddim"</code>)</li>
<li><code>steps</code> (<code>int | None</code>): Number of sampling steps</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>**kwargs</code>: Additional arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Generated samples</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># DDPM sampling (slow but high quality)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">samples_ddpm</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;ddpm&quot;</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="c1"># DDIM sampling (fast)</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">samples_ddim</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;ddim&quot;</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="ddim-denoising-diffusion-implicit-models">DDIM (Denoising Diffusion Implicit Models)<a class="headerlink" href="#ddim-denoising-diffusion-implicit-models" title="Permanent link">Â¤</a></h2>
<h3 id="ddimmodel">DDIMModel<a class="headerlink" href="#ddimmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.ddim.DDIMModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.ddim.DDIMModel</span>


<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">DDIMModel</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.configuration.DDIMConfig">DDIMConfig</span></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.diffusion.ddpm.DDPMModel&lt;/span&gt;" href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel">DDPMModel</a></code></p>



        <p>DDIM (Denoising Diffusion Implicit Models) implementation.</p>
<p>This model implements deterministic sampling from diffusion models
as described in the DDIM paper by Song et al. DDIM enables faster
sampling with fewer steps while maintaining high quality.</p>
<p>Uses nested DDIMConfig with:
- backbone: BackboneConfig (polymorphic) for the denoising network
- noise_schedule: NoiseScheduleConfig for the diffusion schedule
- eta: Stochasticity parameter (0=deterministic, 1=DDPM)
- num_inference_steps: Number of sampling steps
- skip_type: Timestep skip strategy</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="artifex.generative_models.core.configuration.DDIMConfig">DDIMConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DDIMConfig with nested backbone and noise_schedule configs.
    The backbone field accepts any BackboneConfig type and the
    appropriate backbone is created based on backbone_type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.eta" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">eta</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.eta" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">eta</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddim.DDIMModel(config).eta">eta</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_steps" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ddim_steps</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_steps" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ddim_steps</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddim.DDIMModel(config).num_inference_steps">num_inference_steps</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.skip_type" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">skip_type</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.skip_type" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">skip_type</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.ddim.DDIMModel(config).skip_type">skip_type</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.get_ddim_timesteps" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_ddim_timesteps</span>


<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.get_ddim_timesteps" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_ddim_timesteps</span><span class="p">(</span><span class="n">ddim_steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get timesteps for DDIM sampling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ddim_steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of DDIM sampling steps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of timesteps for DDIM sampling</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_step" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">ddim_step</span>


<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_step" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ddim_step</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">t_prev</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">predicted_noise</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">eta</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform a single DDIM sampling step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current sample at timestep t</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current timestep</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_prev</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Previous timestep</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>predicted_noise</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted noise from the model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DDIM interpolation parameter (0=deterministic, 1=DDPM)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample at timestep t_prev</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">ddim_sample</span>


<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ddim_sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">n_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">eta</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate samples using DDIM.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of DDIM steps (default: self.ddim_steps)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DDIM interpolation parameter</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample</span>


<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">n_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">scheduler</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s2">&quot;ddim&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample from the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scheduler</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sampling scheduler ("ddim" or "ddpm")</p>
              </div>
            </td>
            <td>
                  <code>&#39;ddim&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of sampling steps</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_reverse" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">ddim_reverse</span>


<a href="#artifex.generative_models.models.diffusion.ddim.DDIMModel.ddim_reverse" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ddim_reverse</span><span class="p">(</span><span class="n">x0</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">ddim_steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>DDIM reverse process (encoding) from x_0 to noise.</p>
<p>This is useful for image editing applications where you want to
encode a real image into the noise space and then decode it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clean image to encode</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ddim_steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of DDIM steps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Encoded noise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>DDIM implementation with deterministic sampling and fast inference.</p>
<p><strong>Purpose</strong>: Enables much faster sampling (10-20x) than DDPM while maintaining quality, and supports deterministic generation for image editing.</p>
<h4 id="initialization_2">Initialization<a class="headerlink" href="#initialization_2" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">DDIMModel</span><span class="p">(</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>eta</code></td>
<td><code>float</code></td>
<td>0.0</td>
<td>Stochasticity (0=deterministic, 1=DDPM)</td>
</tr>
<tr>
<td><code>ddim_steps</code></td>
<td><code>int</code></td>
<td>50</td>
<td>Number of sampling steps</td>
</tr>
<tr>
<td><code>skip_type</code></td>
<td><code>str</code></td>
<td>"uniform"</td>
<td>Timestep selection ("uniform" or "quadratic")</td>
</tr>
<tr>
<td><code>noise_steps</code></td>
<td><code>int</code></td>
<td>1000</td>
<td>Training timesteps</td>
</tr>
</tbody>
</table>
<h4 id="methods_2">Methods<a class="headerlink" href="#methods_2" title="Permanent link">Â¤</a></h4>
<h5 id="get_ddim_timestepsddim_steps"><code>get_ddim_timesteps(ddim_steps)</code><a class="headerlink" href="#get_ddim_timestepsddim_steps" title="Permanent link">Â¤</a></h5>
<p>Get timesteps for DDIM sampling.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>ddim_steps</code> (<code>int</code>): Number of sampling steps</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Timestep indices for DDIM</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DDIMModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Get 50 uniformly spaced timesteps</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">timesteps</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_ddim_timesteps</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">timesteps</span><span class="p">)</span>  <span class="c1"># [999, 979, 959, ..., 19, 0]</span>
</span></code></pre></div>
<h5 id="ddim_stepx_t-t-t_prev-predicted_noise-etanone-rngsnone"><code>ddim_step(x_t, t, t_prev, predicted_noise, eta=None, *, rngs=None)</code><a class="headerlink" href="#ddim_stepx_t-t-t_prev-predicted_noise-etanone-rngsnone" title="Permanent link">Â¤</a></h5>
<p>Single DDIM sampling step.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x_t</code> (<code>jax.Array</code>): Current sample at timestep <span class="arithmatex">\(t\)</span></li>
<li><code>t</code> (<code>jax.Array</code>): Current timestep</li>
<li><code>t_prev</code> (<code>jax.Array</code>): Previous timestep</li>
<li><code>predicted_noise</code> (<code>jax.Array</code>): Predicted noise</li>
<li><code>eta</code> (<code>float | None</code>): DDIM parameter (0=deterministic)</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Sample at timestep <span class="arithmatex">\(t_{prev}\)</span></li>
</ul>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
x_{t-1} = \sqrt{\bar{\alpha}_{t-1}} \hat{x}_0 + \sqrt{1 - \bar{\alpha}_{t-1} - \sigma_t^2} \epsilon_\theta(x_t, t) + \sigma_t \epsilon
\]</div>
<p>Where <span class="arithmatex">\(\hat{x}_0\)</span> is the predicted clean sample and <span class="arithmatex">\(\sigma_t = \eta \sqrt{(1-\bar{\alpha}_{t-1})/(1-\bar{\alpha}_t)}\sqrt{1-\bar{\alpha}_t/\bar{\alpha}_{t-1}}\)</span></p>
<h5 id="ddim_samplen_samples-stepsnone-etanone-rngsnone-kwargs"><code>ddim_sample(n_samples, steps=None, eta=None, *, rngs=None, **kwargs)</code><a class="headerlink" href="#ddim_samplen_samples-stepsnone-etanone-rngsnone-kwargs" title="Permanent link">Â¤</a></h5>
<p>Generate samples using DDIM.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>n_samples</code> (<code>int</code>): Number of samples</li>
<li><code>steps</code> (<code>int | None</code>): Number of DDIM steps</li>
<li><code>eta</code> (<code>float | None</code>): Stochasticity parameter</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>**kwargs</code>: Additional arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Generated samples</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Deterministic generation (50 steps)</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ddim_sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c1"># Stochastic generation (more diversity)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ddim_sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="ddim_reversex0-ddim_steps-rngsnone-kwargs"><code>ddim_reverse(x0, ddim_steps, *, rngs=None, **kwargs)</code><a class="headerlink" href="#ddim_reversex0-ddim_steps-rngsnone-kwargs" title="Permanent link">Â¤</a></h5>
<p>DDIM reverse process (encoding) from <span class="arithmatex">\(x_0\)</span> to noise.</p>
<p><strong>Purpose</strong>: Encode a real image into the noise space for image editing.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x0</code> (<code>jax.Array</code>): Clean image to encode</li>
<li><code>ddim_steps</code> (<code>int</code>): Number of reverse steps</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>**kwargs</code>: Additional arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Encoded noise</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Encode real image to noise</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">real_image</span> <span class="o">=</span> <span class="n">load_image</span><span class="p">(</span><span class="s2">&quot;photo.png&quot;</span><span class="p">)</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">noise_code</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ddim_reverse</span><span class="p">(</span><span class="n">real_image</span><span class="p">,</span> <span class="n">ddim_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1"># Edit in noise space</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">edited_noise</span> <span class="o">=</span> <span class="n">noise_code</span> <span class="o">+</span> <span class="n">modification</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c1"># Decode back to image</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="n">edited_image</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ddim_sample</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="score-based-models">Score-Based Models<a class="headerlink" href="#score-based-models" title="Permanent link">Â¤</a></h2>
<h3 id="scorediffusionmodel">ScoreDiffusionModel<a class="headerlink" href="#scorediffusionmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.score.ScoreDiffusionModel</span>


<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ScoreDiffusionModel</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.configuration.ScoreDiffusionConfig">ScoreDiffusionConfig</span></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.diffusion.base.DiffusionModel&lt;/span&gt;" href="#artifex.generative_models.models.diffusion.base.DiffusionModel">DiffusionModel</a></code></p>



        <p>Score-based diffusion model.</p>
<p>This model is based on score matching principles where the model
predicts the score (gradient of log-likelihood) instead of noise directly.</p>
<p>Uses nested ScoreDiffusionConfig with:
- backbone: BackboneConfig (polymorphic) for the denoising network
- noise_schedule: NoiseScheduleConfig for the diffusion schedule
- sigma_min: Minimum noise level
- sigma_max: Maximum noise level
- score_scaling: Score function scaling factor</p>
<p>Backbone type is determined by config.backbone.backbone_type discriminator.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="artifex.generative_models.core.configuration.ScoreDiffusionConfig">ScoreDiffusionConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ScoreDiffusionConfig with nested backbone and noise_schedule configs.
    The backbone field accepts any BackboneConfig type and the
    appropriate backbone is created based on backbone_type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators for initialization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_min" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sigma_min</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_min" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sigma_min</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel(config).sigma_min">sigma_min</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_max" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">sigma_max</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sigma_max" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sigma_max</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel(config).sigma_max">sigma_max</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score_scaling" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">score_scaling</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score_scaling" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">score_scaling</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel(config).score_scaling">score_scaling</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.input_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">input_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.input_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel(config).input_shape">input_shape</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">score</span>


<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.score" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">score</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the score function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input samples</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time steps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Score values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.loss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">loss</span>


<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.loss" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">loss</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the score matching loss.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input samples</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample</span>


<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">num_steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">return_trajectory</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate samples using the reverse SDE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of integration steps</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_trajectory</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return full trajectory</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples or trajectory</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.denoise" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">denoise</span>


<a href="#artifex.generative_models.models.diffusion.score.ScoreDiffusionModel.denoise" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">denoise</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Predict denoised output.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy input</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time steps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoised output</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>Score-based diffusion model using score matching.</p>
<p><strong>Purpose</strong>: Implements score-based generative modeling where the model predicts the score function (gradient of log-likelihood) instead of noise directly.</p>
<h4 id="initialization_3">Initialization<a class="headerlink" href="#initialization_3" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">ScoreDiffusionModel</span><span class="p">(</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">,</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sigma_min</code></td>
<td><code>float</code></td>
<td>0.01</td>
<td>Minimum noise level</td>
</tr>
<tr>
<td><code>sigma_max</code></td>
<td><code>float</code></td>
<td>1.0</td>
<td>Maximum noise level</td>
</tr>
<tr>
<td><code>score_scaling</code></td>
<td><code>float</code></td>
<td>1.0</td>
<td>Score scaling factor</td>
</tr>
</tbody>
</table>
<h4 id="methods_3">Methods<a class="headerlink" href="#methods_3" title="Permanent link">Â¤</a></h4>
<h5 id="scorex-t"><code>score(x, t)</code><a class="headerlink" href="#scorex-t" title="Permanent link">Â¤</a></h5>
<p>Compute the score function <span class="arithmatex">\(\nabla_x \log p_t(x)\)</span>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x</code> (<code>jax.Array</code>): Input samples</li>
<li><code>t</code> (<code>jax.Array</code>): Time steps in [0, 1]</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Score values</li>
</ul>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
\nabla_x \log p_t(x) = -\frac{\epsilon}{\sigma_t}
\]</div>
<h5 id="samplenum_samples-rngsnone-num_steps1000-return_trajectoryfalse"><code>sample(num_samples, *, rngs=None, num_steps=1000, return_trajectory=False)</code><a class="headerlink" href="#samplenum_samples-rngsnone-num_steps1000-return_trajectoryfalse" title="Permanent link">Â¤</a></h5>
<p>Generate samples using reverse SDE.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>num_samples</code> (<code>int</code>): Number of samples</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>num_steps</code> (<code>int</code>): Number of integration steps</li>
<li><code>return_trajectory</code> (<code>bool</code>): Return full trajectory</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array | list[jax.Array]</code>: Samples or trajectory</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">ScoreDiffusionModel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># Generate samples</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1"># Get full trajectory</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">trajectory</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">return_trajectory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trajectory length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 1000 steps</span>
</span></code></pre></div>
<hr />
<h2 id="latent-diffusion-models">Latent Diffusion Models<a class="headerlink" href="#latent-diffusion-models" title="Permanent link">Â¤</a></h2>
<h3 id="ldmmodel">LDMModel<a class="headerlink" href="#ldmmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.latent.LDMModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.latent.LDMModel</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">LDMModel</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.configuration.LatentDiffusionConfig">LatentDiffusionConfig</span></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.diffusion.ddpm.DDPMModel&lt;/span&gt;" href="#artifex.generative_models.models.diffusion.ddpm.DDPMModel">DDPMModel</a></code></p>



        <p>Latent Diffusion Model implementation.</p>
<p>This model combines a VAE for encoding/decoding with a diffusion model
that operates in the latent space.</p>
<p>Uses nested LatentDiffusionConfig with:
- backbone: BackboneConfig (polymorphic) for the denoising network
- noise_schedule: NoiseScheduleConfig for the diffusion schedule
- encoder: EncoderConfig for encoding to latent space
- decoder: DecoderConfig for decoding from latent space
- latent_scale_factor: Scaling factor for latent codes</p>
<p>Supports both 1D and 2D backbones:
- UNet1D: Works with (batch, sequence, channels) format
- UNet/DiT: Works with (batch, H, W, C) spatial format</p>
<p>Flat latent codes from the MLP encoder are automatically reshaped to the
appropriate format for the backbone.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="artifex.generative_models.core.configuration.LatentDiffusionConfig">LatentDiffusionConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LatentDiffusionConfig with nested configs for backbone,
    noise_schedule, encoder, and decoder.
    The backbone field accepts any BackboneConfig type and the
    appropriate backbone is created based on backbone_type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.original_input_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">original_input_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.original_input_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">original_input_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(config).input_shape">input_shape</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.latent_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">latent_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.latent_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">latent_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(config).encoder.latent_dim">latent_dim</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.scale_factor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">scale_factor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.scale_factor" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">scale_factor</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(config).latent_scale_factor">latent_scale_factor</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.encoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">encoder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.encoder" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">encoder</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.vae.encoders.MLPEncoder&lt;/span&gt;" href="../vae/#artifex.generative_models.models.vae.encoders.MLPEncoder">MLPEncoder</a></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.vae.encoders.MLPEncoder(config)">config</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(config).encoder">encoder</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.models.vae.encoders.MLPEncoder(rngs)">rngs</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.decoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">decoder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.decoder" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">decoder</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.vae.decoders.MLPDecoder&lt;/span&gt;" href="../vae/#artifex.generative_models.models.vae.decoders.MLPDecoder">MLPDecoder</a></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.vae.decoders.MLPDecoder(config)">config</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(config).decoder">decoder</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.models.vae.decoders.MLPDecoder(rngs)">rngs</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.use_pretrained_vae" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">use_pretrained_vae</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.use_pretrained_vae" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">use_pretrained_vae</span> <span class="o">=</span> <span class="kc">False</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.input_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">input_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.input_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.LDMModel(self)._latent_spatial_shape">_latent_spatial_shape</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.output_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.output_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">output_dim</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get output dimensions.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.encode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">encode</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.encode" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">encode</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Encode input to latent space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>, <a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (latent_code, posterior_params)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.decode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">decode</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.decode" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">decode</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Decode latent code to output space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>z</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latent code</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decoded output</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.reparameterize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">reparameterize</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.reparameterize" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">reparameterize</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">mean</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">logvar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Reparameterization trick.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mean</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean of the latent distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logvar</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Log variance of the latent distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sampled latent code</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.denoise" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">denoise</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.denoise" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">denoise</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Predict noise from noisy input using the backbone.</p>
<p>Handles reshaping between flat and spatial formats as needed
by the backbone type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Noisy input (flat format: batch, latent_dim)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestep indices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted noise (same shape as input)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.sample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.sample" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sample</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">num_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">return_trajectory</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample from the model by generating in latent space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_trajectory</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return full trajectory</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples (decoded to image space) or trajectory</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.latent.LDMModel.loss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">loss</span>


<a href="#artifex.generative_models.models.diffusion.latent.LDMModel.loss" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">loss</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute LDM loss.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input images</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps (optional)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loss value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>Latent Diffusion Model combining VAE and diffusion in latent space.</p>
<p><strong>Purpose</strong>: Applies diffusion in a compressed latent space for efficient high-resolution generation. Foundation of Stable Diffusion.</p>
<h4 id="initialization_4">Initialization<a class="headerlink" href="#initialization_4" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">LDMModel</span><span class="p">(</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>latent_dim</code></td>
<td><code>int</code></td>
<td>8</td>
<td>Latent space dimension</td>
</tr>
<tr>
<td><code>encoder_hidden_dims</code></td>
<td><code>list[int]</code></td>
<td>[32, 64]</td>
<td>Encoder layer sizes</td>
</tr>
<tr>
<td><code>decoder_hidden_dims</code></td>
<td><code>list[int]</code></td>
<td>[64, 32]</td>
<td>Decoder layer sizes</td>
</tr>
<tr>
<td><code>encoder_type</code></td>
<td><code>str</code></td>
<td>"simple"</td>
<td>Encoder type ("simple" or "vae")</td>
</tr>
<tr>
<td><code>decoder_type</code></td>
<td><code>str</code></td>
<td>"simple"</td>
<td>Decoder type</td>
</tr>
<tr>
<td><code>scale_factor</code></td>
<td><code>float</code></td>
<td>0.18215</td>
<td>Latent scaling factor</td>
</tr>
</tbody>
</table>
<h4 id="methods_4">Methods<a class="headerlink" href="#methods_4" title="Permanent link">Â¤</a></h4>
<h5 id="encodex"><code>encode(x)</code><a class="headerlink" href="#encodex" title="Permanent link">Â¤</a></h5>
<p>Encode input to latent space.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x</code> (<code>jax.Array</code>): Input images</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>tuple[jax.Array, jax.Array]</code>: <code>(mean, logvar)</code> of latent distribution</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">LDMModel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># Encode images to latent space</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">images</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">mean</span><span class="p">,</span> <span class="n">logvar</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latent mean: </span><span class="si">{</span><span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>      <span class="c1"># (8, 16)</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latent logvar: </span><span class="si">{</span><span class="n">logvar</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (8, 16)</span>
</span></code></pre></div>
<h5 id="decodez"><code>decode(z)</code><a class="headerlink" href="#decodez" title="Permanent link">Â¤</a></h5>
<p>Decode latent code to image space.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>z</code> (<code>jax.Array</code>): Latent codes</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Decoded images</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Sample latent code</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">z</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># Decode to images</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="n">images</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decoded images: </span><span class="si">{</span><span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (8, 64, 64, 3)</span>
</span></code></pre></div>
<h5 id="reparameterizemean-logvar-rngs"><code>reparameterize(mean, logvar, *, rngs)</code><a class="headerlink" href="#reparameterizemean-logvar-rngs" title="Permanent link">Â¤</a></h5>
<p>Reparameterization trick for sampling.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>mean</code> (<code>jax.Array</code>): Mean of latent distribution</li>
<li><code>logvar</code> (<code>jax.Array</code>): Log variance of latent distribution</li>
<li><code>rngs</code> (<code>nnx.Rngs</code>): Random number generators</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Sampled latent code</li>
</ul>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
z = \mu + \sigma \odot \epsilon, \quad \epsilon \sim \mathcal{N}(0, I)
\]</div>
<h5 id="samplenum_samples-rngsnone-return_trajectoryfalse"><code>sample(num_samples, *, rngs=None, return_trajectory=False)</code><a class="headerlink" href="#samplenum_samples-rngsnone-return_trajectoryfalse" title="Permanent link">Â¤</a></h5>
<p>Generate samples (automatically encoded/decoded).</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>num_samples</code> (<code>int</code>): Number of samples</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>return_trajectory</code> (<code>bool</code>): Return full trajectory</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array | list[jax.Array]</code>: Generated images</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Generate high-resolution images efficiently</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated: </span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (16, 64, 64, 3)</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1"># Diffusion happens in compressed 16D latent space!</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1"># 8x faster than pixel-space diffusion</span>
</span></code></pre></div>
<hr />
<h2 id="diffusion-transformers">Diffusion Transformers<a class="headerlink" href="#diffusion-transformers" title="Permanent link">Â¤</a></h2>
<h3 id="ditmodel">DiTModel<a class="headerlink" href="#ditmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.dit.DiTModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.dit.DiTModel</span>


<a href="#artifex.generative_models.models.diffusion.dit.DiTModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">DiTModel</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.configuration.DiTConfig">DiTConfig</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">backbone_fn</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Callable&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">[[</span><span class="n"><span title="artifex.generative_models.core.configuration.DiTConfig">DiTConfig</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a></span><span class="p">]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="artifex.generative_models.core.base.GenerativeModel">GenerativeModel</span></code></p>



        <p>Diffusion model using Transformer backbone instead of U-Net.</p>
<p>Implements Diffusion Transformers (DiT) which replace the U-Net backbone
with a Vision Transformer for improved scalability and performance.</p>
<p>Uses nested DiTConfig with:
- noise_schedule: NoiseScheduleConfig for the diffusion schedule
- patch_size, hidden_size, depth, num_heads, mlp_ratio: Transformer architecture
- num_classes: Number of classes for conditional generation
- cfg_scale: Classifier-free guidance scale</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="artifex.generative_models.core.configuration.DiTConfig">DiTConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DiTConfig with DiT-specific parameters and noise_schedule</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>backbone_fn</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Callable&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="artifex.generative_models.core.configuration.DiTConfig">DiTConfig</span>, <a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a>], <a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom backbone function</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">config</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.config" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">config</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config)">config</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.num_classes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">num_classes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.num_classes" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">num_classes</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).num_classes">num_classes</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.cfg_scale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">cfg_scale</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.cfg_scale" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cfg_scale</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).cfg_scale">cfg_scale</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.learn_sigma" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">learn_sigma</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.learn_sigma" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">learn_sigma</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).learn_sigma">learn_sigma</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.input_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">input_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.input_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).input_shape">input_shape</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.in_channels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">in_channels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.in_channels" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">in_channels</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).input_shape">input_shape</span></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.img_size" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">img_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.img_size" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">img_size</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).input_shape">input_shape</span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.noise_schedule" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">noise_schedule</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.noise_schedule" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">noise_schedule</span><span class="p">:</span> <span class="n"><span title="artifex.generative_models.core.noise_schedule.NoiseSchedule">NoiseSchedule</span></span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.core.noise_schedule.create_noise_schedule">create_noise_schedule</span></span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config).noise_schedule">noise_schedule</span></span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.betas" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">betas</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.betas" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">betas</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(self).noise_schedule.betas">betas</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.alphas" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">alphas</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.alphas" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">alphas</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(self).noise_schedule.alphas">alphas</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.alphas_cumprod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">alphas_cumprod</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.alphas_cumprod" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">alphas_cumprod</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(self).noise_schedule.alphas_cumprod">alphas_cumprod</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.backbone" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">backbone</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.backbone" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">backbone</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(backbone_fn)">backbone_fn</span></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(config)">config</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.models.diffusion.dit.DiTModel(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.sample_step" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">sample_step</span>


<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.sample_step" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sample_step</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x_t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">y</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">cfg_scale</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Single sampling step with optional classifier-free guidance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current noisy sample [batch, height, width, channels]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current timestep [batch]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional class labels for conditional generation</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg_scale</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Classifier-free guidance scale</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoised sample [batch, height, width, channels]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.dit.DiTModel.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


<a href="#artifex.generative_models.models.diffusion.dit.DiTModel.generate" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">generate</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">n_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">num_steps</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">y</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">cfg_scale</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">img_size</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate samples using DiT.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of diffusion steps</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional class labels for conditional generation</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg_scale</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Classifier-free guidance scale</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>img_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image size (uses config default if not specified)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples [n_samples, height, width, channels]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>Diffusion model using Vision Transformer backbone.</p>
<p><strong>Purpose</strong>: Replaces U-Net with Transformer for better scalability and state-of-the-art quality at large model sizes.</p>
<h4 id="initialization_5">Initialization<a class="headerlink" href="#initialization_5" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">DiTModel</span><span class="p">(</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">,</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="n">backbone_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="o">**</span><span class="n">kwargs</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>img_size</code></td>
<td><code>int</code></td>
<td>32</td>
<td>Image size</td>
</tr>
<tr>
<td><code>patch_size</code></td>
<td><code>int</code></td>
<td>2</td>
<td>Patch size for Vision Transformer</td>
</tr>
<tr>
<td><code>hidden_size</code></td>
<td><code>int</code></td>
<td>512</td>
<td>Transformer hidden dimension</td>
</tr>
<tr>
<td><code>depth</code></td>
<td><code>int</code></td>
<td>12</td>
<td>Number of transformer layers</td>
</tr>
<tr>
<td><code>num_heads</code></td>
<td><code>int</code></td>
<td>8</td>
<td>Number of attention heads</td>
</tr>
<tr>
<td><code>mlp_ratio</code></td>
<td><code>float</code></td>
<td>4.0</td>
<td>MLP expansion ratio</td>
</tr>
<tr>
<td><code>num_classes</code></td>
<td><code>int | None</code></td>
<td>None</td>
<td>Number of classes for conditioning</td>
</tr>
<tr>
<td><code>dropout_rate</code></td>
<td><code>float</code></td>
<td>0.0</td>
<td>Dropout rate</td>
</tr>
<tr>
<td><code>learn_sigma</code></td>
<td><code>bool</code></td>
<td>False</td>
<td>Learn variance</td>
</tr>
<tr>
<td><code>cfg_scale</code></td>
<td><code>float</code></td>
<td>1.0</td>
<td>Classifier-free guidance scale</td>
</tr>
</tbody>
</table>
<h4 id="methods_5">Methods<a class="headerlink" href="#methods_5" title="Permanent link">Â¤</a></h4>
<h5 id="__call__x-t-ynone-deterministicfalse-cfg_scalenone"><code>__call__(x, t, y=None, *, deterministic=False, cfg_scale=None)</code><a class="headerlink" href="#__call__x-t-ynone-deterministicfalse-cfg_scalenone" title="Permanent link">Â¤</a></h5>
<p>Forward pass through DiT model.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>x</code> (<code>jax.Array</code>): Input images <code>(batch, H, W, C)</code></li>
<li><code>t</code> (<code>jax.Array</code>): Timesteps <code>(batch,)</code></li>
<li><code>y</code> (<code>jax.Array | None</code>): Optional class labels</li>
<li><code>deterministic</code> (<code>bool</code>): Whether to apply dropout</li>
<li><code>cfg_scale</code> (<code>float | None</code>): Classifier-free guidance scale</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Predicted noise</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DiTModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="c1"># Forward pass</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rngs</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># Class labels</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">noise_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<h5 id="generaten_samples1-rngs-num_steps1000-ynone-cfg_scalenone-img_sizenone-kwargs"><code>generate(n_samples=1, *, rngs, num_steps=1000, y=None, cfg_scale=None, img_size=None, **kwargs)</code><a class="headerlink" href="#generaten_samples1-rngs-num_steps1000-ynone-cfg_scalenone-img_sizenone-kwargs" title="Permanent link">Â¤</a></h5>
<p>Generate samples using DiT.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>n_samples</code> (<code>int</code>): Number of samples</li>
<li><code>rngs</code> (<code>nnx.Rngs</code>): Random number generators</li>
<li><code>num_steps</code> (<code>int</code>): Number of diffusion steps</li>
<li><code>y</code> (<code>jax.Array | None</code>): Class labels for conditional generation</li>
<li><code>cfg_scale</code> (<code>float | None</code>): Classifier-free guidance scale</li>
<li><code>img_size</code> (<code>int | None</code>): Image size</li>
<li><code>**kwargs</code>: Additional arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Generated samples</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Unconditional generation</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Conditional generation with classifier-free guidance</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">class_labels</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)])</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="n">n_samples</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>    <span class="n">y</span><span class="o">=</span><span class="n">class_labels</span><span class="p">,</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>    <span class="n">cfg_scale</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>  <span class="c1"># Strong conditioning</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>    <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">,</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    <span class="n">num_steps</span><span class="o">=</span><span class="mi">1000</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="guidance-techniques">Guidance Techniques<a class="headerlink" href="#guidance-techniques" title="Permanent link">Â¤</a></h2>
<h3 id="classifierfreeguidance">ClassifierFreeGuidance<a class="headerlink" href="#classifierfreeguidance" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance</span>


<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ClassifierFreeGuidance</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">guidance_scale</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">unconditional_conditioning</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">



        <p>Classifier-free guidance for conditional diffusion models.</p>
<p>This implements the classifier-free guidance technique that allows
trading off between sample diversity and adherence to conditioning.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>guidance_scale</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guidance strength (higher = more conditioning)</p>
              </div>
            </td>
            <td>
                  <code>7.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unconditional_conditioning</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unconditional conditioning token/embedding</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.guidance_scale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">guidance_scale</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.guidance_scale" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">guidance_scale</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance(guidance_scale)">guidance_scale</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.unconditional_conditioning" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">unconditional_conditioning</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance.unconditional_conditioning" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">unconditional_conditioning</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance(unconditional_conditioning)">unconditional_conditioning</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><p>Classifier-free guidance for conditional generation.</p>
<p><strong>Purpose</strong>: Enables strong conditioning without needing a separate classifier by training a single model to handle both conditional and unconditional generation.</p>
<h4 id="initialization_6">Initialization<a class="headerlink" href="#initialization_6" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">ClassifierFreeGuidance</span><span class="p">(</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>    <span class="n">guidance_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">,</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>    <span class="n">unconditional_conditioning</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>guidance_scale</code></td>
<td><code>float</code></td>
<td>7.5</td>
<td>Guidance strength (higher = stronger conditioning)</td>
</tr>
<tr>
<td><code>unconditional_conditioning</code></td>
<td><code>Any | None</code></td>
<td>None</td>
<td>Unconditional token/embedding</td>
</tr>
</tbody>
</table>
<h4 id="methods_6">Methods<a class="headerlink" href="#methods_6" title="Permanent link">Â¤</a></h4>
<h5 id="__call__model-x-t-conditioning-rngsnone-kwargs"><code>__call__(model, x, t, conditioning, *, rngs=None, **kwargs)</code><a class="headerlink" href="#__call__model-x-t-conditioning-rngsnone-kwargs" title="Permanent link">Â¤</a></h5>
<p>Apply classifier-free guidance.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>model</code> (<code>DiffusionModel</code>): Diffusion model</li>
<li><code>x</code> (<code>jax.Array</code>): Noisy input</li>
<li><code>t</code> (<code>jax.Array</code>): Timesteps</li>
<li><code>conditioning</code> (<code>Any</code>): Conditioning information</li>
<li><code>rngs</code> (<code>nnx.Rngs | None</code>): Random number generators</li>
<li><code>**kwargs</code>: Additional arguments</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Guided noise prediction</li>
</ul>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
\tilde{\epsilon} = \epsilon_\theta(x_t, \emptyset) + w \cdot (\epsilon_\theta(x_t, c) - \epsilon_\theta(x_t, \emptyset))
\]</div>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">artifex.generative_models.models.diffusion.guidance</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassifierFreeGuidance</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="c1"># Create guidance</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="n">cfg</span> <span class="o">=</span> <span class="n">ClassifierFreeGuidance</span><span class="p">(</span><span class="n">guidance_scale</span><span class="o">=</span><span class="mf">7.5</span><span class="p">)</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="c1"># Use during sampling</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="n">x_t</span> <span class="o">=</span> <span class="n">noisy_sample</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="n">t</span> <span class="o">=</span> <span class="n">timesteps</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="n">conditioning</span> <span class="o">=</span> <span class="n">class_labels</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="n">guided_noise</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">conditioning</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="classifierguidance">ClassifierGuidance<a class="headerlink" href="#classifierguidance" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.guidance.ClassifierGuidance</span>


<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ClassifierGuidance</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">classifier</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">guidance_scale</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">class_label</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">



        <p>Classifier guidance for diffusion models.</p>
<p>Uses a pre-trained classifier to guide the generation process
towards desired classes.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>classifier</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pre-trained classifier model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guidance_scale</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guidance strength</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>class_label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target class label for guidance</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.classifier" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">classifier</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.classifier" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">classifier</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance(classifier)">classifier</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.guidance_scale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">guidance_scale</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.guidance_scale" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">guidance_scale</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance(guidance_scale)">guidance_scale</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.class_label" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">class_label</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.ClassifierGuidance.class_label" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">class_label</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierGuidance(class_label)">class_label</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><p>Classifier guidance using a pre-trained classifier.</p>
<p><strong>Purpose</strong>: Uses gradients from a pre-trained classifier to guide generation towards desired classes.</p>
<h4 id="initialization_7">Initialization<a class="headerlink" href="#initialization_7" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">ClassifierGuidance</span><span class="p">(</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>    <span class="n">classifier</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="n">guidance_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="n">class_label</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>classifier</code></td>
<td><code>nnx.Module</code></td>
<td>Pre-trained classifier model</td>
</tr>
<tr>
<td><code>guidance_scale</code></td>
<td><code>float</code></td>
<td>Guidance strength</td>
</tr>
<tr>
<td><code>class_label</code></td>
<td><code>int | None</code></td>
<td>Target class for guidance</td>
</tr>
</tbody>
</table>
<h4 id="methods_7">Methods<a class="headerlink" href="#methods_7" title="Permanent link">Â¤</a></h4>
<h5 id="__call__model-x-t-rngsnone-class_labelnone-kwargs"><code>__call__(model, x, t, *, rngs=None, class_label=None, **kwargs)</code><a class="headerlink" href="#__call__model-x-t-rngsnone-class_labelnone-kwargs" title="Permanent link">Â¤</a></h5>
<p>Apply classifier guidance.</p>
<p><strong>Mathematical Formula:</strong></p>
<div class="arithmatex">\[
\tilde{\epsilon} = \epsilon_\theta(x_t) - w \sqrt{1 - \bar{\alpha}_t} \nabla_{x_t} \log p_\phi(y | x_t)
\]</div>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">artifex.generative_models.models.diffusion.guidance</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassifierGuidance</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1"># Load pre-trained classifier</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">classifier</span> <span class="o">=</span> <span class="n">load_classifier</span><span class="p">()</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="c1"># Create classifier guidance</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="n">cg</span> <span class="o">=</span> <span class="n">ClassifierGuidance</span><span class="p">(</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>    <span class="n">classifier</span><span class="o">=</span><span class="n">classifier</span><span class="p">,</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>    <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>    <span class="n">class_label</span><span class="o">=</span><span class="mi">5</span>  <span class="c1"># Generate class 5</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="p">)</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="c1"># Use during sampling</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="n">guided_noise</span> <span class="o">=</span> <span class="n">cg</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="guideddiffusionmodel">GuidedDiffusionModel<a class="headerlink" href="#guideddiffusionmodel" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel</span>


<a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">GuidedDiffusionModel</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">guidance_method</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">guidance_scale</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">classifier</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.diffusion.base.DiffusionModel&lt;/span&gt;" href="#artifex.generative_models.models.diffusion.base.DiffusionModel">DiffusionModel</a></code></p>



        <p>Diffusion model with built-in guidance support.</p>
<p>This extends the base diffusion model to support various guidance
techniques during generation.</p>
<p>Uses the polymorphic backbone system - backbone type is determined
by config.backbone.backbone_type discriminator.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model configuration with nested BackboneConfig.
    The backbone is created based on backbone_type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guidance_method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of guidance ("classifier_free", "classifier", None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>guidance_scale</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guidance strength</p>
              </div>
            </td>
            <td>
                  <code>7.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>classifier</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Classifier for classifier guidance</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_method" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">guidance_method</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_method" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">guidance_method</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel(guidance_method)">guidance_method</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_scale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">guidance_scale</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance_scale" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">guidance_scale</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel(guidance_scale)">guidance_scale</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">guidance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guidance" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">guidance</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance&lt;/span&gt;" href="#artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance">ClassifierFreeGuidance</a></span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance(guidance_scale)">guidance_scale</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel(guidance_scale)">guidance_scale</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.ClassifierFreeGuidance(unconditional_conditioning)">unconditional_conditioning</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#getattr">getattr</a></span><span class="p">(</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="n"><span title="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel(config)">config</span></span><span class="p">,</span> <span class="s2">&quot;unconditional_token&quot;</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="p">),</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guided_sample_step" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">guided_sample_step</span>


<a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.guided_sample_step" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">guided_sample_step</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">x</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">t</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">conditioning</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Single sampling step with guidance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current sample</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timesteps</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conditioning</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Conditioning information</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guided noise prediction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>NNX models store RNGs at init time, no need to pass rngs.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.generate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate</span>


<a href="#artifex.generative_models.models.diffusion.guidance.GuidedDiffusionModel.generate" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">generate</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">n_samples</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">conditioning</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">clip_denoised</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate samples with guidance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conditioning</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Conditioning information for guided generation</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, ...] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample shape</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_denoised</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to clip denoised samples</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;typing.Any&lt;/code&gt;" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;jax.Array&lt;/code&gt;" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array">Array</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated samples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p>Diffusion model with built-in guidance support.</p>
<p><strong>Purpose</strong>: Extends base diffusion model to support various guidance techniques during generation.</p>
<h4 id="initialization_8">Initialization<a class="headerlink" href="#initialization_8" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">GuidedDiffusionModel</span><span class="p">(</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="n">backbone_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">,</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>    <span class="n">guidance_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>    <span class="n">guidance_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">,</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>    <span class="n">classifier</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>guidance_method</code></td>
<td><code>str | None</code></td>
<td>Guidance type ("classifier_free", "classifier", None)</td>
</tr>
<tr>
<td><code>guidance_scale</code></td>
<td><code>float</code></td>
<td>Guidance strength</td>
</tr>
<tr>
<td><code>classifier</code></td>
<td><code>nnx.Module | None</code></td>
<td>Classifier for classifier guidance</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">artifex.generative_models.models.diffusion.guidance</span><span class="w"> </span><span class="kn">import</span> <span class="n">GuidedDiffusionModel</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="c1"># Create model with classifier-free guidance</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">GuidedDiffusionModel</span><span class="p">(</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>    <span class="n">config</span><span class="p">,</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>    <span class="n">backbone_fn</span><span class="p">,</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>    <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">,</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>    <span class="n">guidance_method</span><span class="o">=</span><span class="s2">&quot;classifier_free&quot;</span><span class="p">,</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>    <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">7.5</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="p">)</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="c1"># Generate with conditioning</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>    <span class="n">n_samples</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>    <span class="n">conditioning</span><span class="o">=</span><span class="n">class_labels</span><span class="p">,</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>    <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="guidance-utility-functions">Guidance Utility Functions<a class="headerlink" href="#guidance-utility-functions" title="Permanent link">Â¤</a></h3>
<h4 id="apply_guidancenoise_pred_cond-noise_pred_uncond-guidance_scale"><code>apply_guidance(noise_pred_cond, noise_pred_uncond, guidance_scale)</code><a class="headerlink" href="#apply_guidancenoise_pred_cond-noise_pred_uncond-guidance_scale" title="Permanent link">Â¤</a></h4>
<p>Apply classifier-free guidance formula.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>noise_pred_cond</code> (<code>jax.Array</code>): Conditional noise prediction</li>
<li><code>noise_pred_uncond</code> (<code>jax.Array</code>): Unconditional noise prediction</li>
<li><code>guidance_scale</code> (<code>float</code>): Guidance strength</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>jax.Array</code>: Guided noise prediction</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">artifex.generative_models.models.diffusion.guidance</span><span class="w"> </span><span class="kn">import</span> <span class="n">apply_guidance</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c1"># Get predictions</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="n">noise_cond</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">conditioning</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="n">noise_uncond</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">conditioning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c1"># Apply guidance</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="n">guided</span> <span class="o">=</span> <span class="n">apply_guidance</span><span class="p">(</span><span class="n">noise_cond</span><span class="p">,</span> <span class="n">noise_uncond</span><span class="p">,</span> <span class="n">guidance_scale</span><span class="o">=</span><span class="mf">7.5</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="linear_guidance_schedulestep-total_steps-start_scale10-end_scale75"><code>linear_guidance_schedule(step, total_steps, start_scale=1.0, end_scale=7.5)</code><a class="headerlink" href="#linear_guidance_schedulestep-total_steps-start_scale10-end_scale75" title="Permanent link">Â¤</a></h4>
<p>Linear guidance scale schedule.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>step</code> (<code>int</code>): Current step</li>
<li><code>total_steps</code> (<code>int</code>): Total number of steps</li>
<li><code>start_scale</code> (<code>float</code>): Starting guidance scale</li>
<li><code>end_scale</code> (<code>float</code>): Ending guidance scale</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>float</code>: Guidance scale for current step</li>
</ul>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">artifex.generative_models.models.diffusion.guidance</span><span class="w"> </span><span class="kn">import</span> <span class="n">linear_guidance_schedule</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c1"># Gradually increase guidance during sampling</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">):</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="n">linear_guidance_schedule</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">total_steps</span><span class="p">,</span> <span class="n">start_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">end_scale</span><span class="o">=</span><span class="mf">7.5</span><span class="p">)</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>    <span class="c1"># Use scale for this step</span>
</span></code></pre></div>
<h4 id="cosine_guidance_schedulestep-total_steps-start_scale10-end_scale75"><code>cosine_guidance_schedule(step, total_steps, start_scale=1.0, end_scale=7.5)</code><a class="headerlink" href="#cosine_guidance_schedulestep-total_steps-start_scale10-end_scale75" title="Permanent link">Â¤</a></h4>
<p>Cosine guidance scale schedule.</p>
<p><strong>Example:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">artifex.generative_models.models.diffusion.guidance</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_guidance_schedule</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1"># Use cosine schedule (higher guidance at beginning and end)</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">):</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="n">cosine_guidance_schedule</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">total_steps</span><span class="p">)</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    <span class="c1"># Use scale for this step</span>
</span></code></pre></div>
<hr />
<h2 id="auxiliary-classes">Auxiliary Classes<a class="headerlink" href="#auxiliary-classes" title="Permanent link">Â¤</a></h2>
<h3 id="simpleencoder">SimpleEncoder<a class="headerlink" href="#simpleencoder" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.latent.SimpleEncoder</span>


<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">SimpleEncoder</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">input_dim</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">latent_dim</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">hidden_dims</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a></code></p>



        <p>Simple encoder for latent diffusion model.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_dim</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dimensions (H, W, C) for images or (D,) for vectors</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>latent_dim</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latent dimension</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hidden_dims</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hidden layer dimensions</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.input_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">input_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.input_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(input_dim)">input_dim</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.latent_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">latent_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.latent_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">latent_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(latent_dim)">latent_dim</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.hidden_dims" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">hidden_dims</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.hidden_dims" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">hidden_dims</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(hidden_dims)">hidden_dims</span></span> <span class="ow">or</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.is_image" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_image</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.is_image" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_image</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#isinstance">isinstance</a></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(input_dim)">input_dim</span></span><span class="p">,</span> <span class="p">(</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">))</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="ow">and</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#len">len</a></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(input_dim)">input_dim</span></span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.flat_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">flat_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.flat_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">flat_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(input_dim)">input_dim</span></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(input_dim)">input_dim</span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(input_dim)">input_dim</span></span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.layers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">layers</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.layers" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">layers</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.List&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/helpers.html#flax.nnx.List">List</a></span><span class="p">([])</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.mean_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mean_layer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.mean_layer" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">mean_layer</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Linear&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/linear.html#flax.nnx.Linear">Linear</a></span><span class="p">(</span><span class="n"><span title="in_features">in_features</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(latent_dim)">latent_dim</span></span><span class="p">,</span> <span class="n"><span title="flax.nnx.Linear(rngs)">rngs</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleEncoder.logvar_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logvar_layer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleEncoder.logvar_layer" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">logvar_layer</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Linear&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/linear.html#flax.nnx.Linear">Linear</a></span><span class="p">(</span><span class="n"><span title="in_features">in_features</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(latent_dim)">latent_dim</span></span><span class="p">,</span> <span class="n"><span title="flax.nnx.Linear(rngs)">rngs</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleEncoder(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><p>Simple MLP encoder for Latent Diffusion Models.</p>
<p><strong>Purpose</strong>: Encodes images to latent space with mean and log variance.</p>
<h4 id="initialization_9">Initialization<a class="headerlink" href="#initialization_9" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">SimpleEncoder</span><span class="p">(</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>    <span class="n">input_dim</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>    <span class="n">latent_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>    <span class="n">hidden_dims</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="simpledecoder">SimpleDecoder<a class="headerlink" href="#simpledecoder" title="Permanent link">Â¤</a></h3>


<div class="doc doc-object doc-class">



<h2 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">artifex.generative_models.models.diffusion.latent.SimpleDecoder</span>


<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder" class="headerlink" title="Permanent link">Â¤</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">SimpleDecoder</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">latent_dim</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">output_dim</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">hidden_dims</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Module&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/module.html#flax.nnx.Module">Module</a></code></p>



        <p>Simple decoder for latent diffusion model.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>latent_dim</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Latent dimension</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_dim</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output dimensions (H, W, C) for images or (D,) for vectors</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hidden_dims</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hidden layer dimensions (in reverse order)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rngs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Rngs&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/rnglib.html#flax.nnx.Rngs">Rngs</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generators</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.latent_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">latent_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.latent_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">latent_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(latent_dim)">latent_dim</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">output_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(output_dim)">output_dim</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.hidden_dims" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">hidden_dims</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.hidden_dims" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">hidden_dims</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(hidden_dims)">hidden_dims</span></span> <span class="ow">or</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.is_image" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_image</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.is_image" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_image</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#isinstance">isinstance</a></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(output_dim)">output_dim</span></span><span class="p">,</span> <span class="p">(</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">))</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="ow">and</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#len">len</a></span><span class="p">(</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(output_dim)">output_dim</span></span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.flat_dim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">flat_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.flat_dim" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">flat_dim</span> <span class="o">=</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(output_dim)">output_dim</span></span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(output_dim)">output_dim</span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(output_dim)">output_dim</span></span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.layers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">layers</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.layers" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">layers</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.List&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/helpers.html#flax.nnx.List">List</a></span><span class="p">([])</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_layer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output_layer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#artifex.generative_models.models.diffusion.latent.SimpleDecoder.output_layer" class="headerlink" title="Permanent link">Â¤</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">output_layer</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="&lt;code&gt;flax.nnx.Linear&lt;/code&gt;" href="https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/linear.html#flax.nnx.Linear">Linear</a></span><span class="p">(</span><span class="n"><span title="in_features">in_features</span></span><span class="p">,</span> <span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(self).flat_dim">flat_dim</span></span><span class="p">,</span> <span class="n"><span title="flax.nnx.Linear(rngs)">rngs</span></span><span class="o">=</span><span class="n"><span title="artifex.generative_models.models.diffusion.latent.SimpleDecoder(rngs)">rngs</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><p>Simple MLP decoder for Latent Diffusion Models.</p>
<p><strong>Purpose</strong>: Decodes latent codes back to image space.</p>
<h4 id="initialization_10">Initialization<a class="headerlink" href="#initialization_10" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">SimpleDecoder</span><span class="p">(</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>    <span class="n">latent_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>    <span class="n">output_dim</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>    <span class="n">hidden_dims</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>    <span class="n">rngs</span><span class="p">:</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="configuration-reference">Configuration Reference<a class="headerlink" href="#configuration-reference" title="Permanent link">Â¤</a></h2>
<h3 id="modelconfig-for-diffusion-models">ModelConfig for Diffusion Models<a class="headerlink" href="#modelconfig-for-diffusion-models" title="Permanent link">Â¤</a></h3>
<p>Complete reference of configuration parameters for all diffusion models.</p>
<h4 id="base-parameters">Base Parameters<a class="headerlink" href="#base-parameters" title="Permanent link">Â¤</a></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>Yes</td>
<td>Model name</td>
</tr>
<tr>
<td><code>model_class</code></td>
<td><code>str</code></td>
<td>Yes</td>
<td>Model class name</td>
</tr>
<tr>
<td><code>input_dim</code></td>
<td><code>tuple[int, ...]</code></td>
<td>Yes</td>
<td>Input dimensions (H, W, C)</td>
</tr>
<tr>
<td><code>hidden_dims</code></td>
<td><code>list[int]</code></td>
<td>No</td>
<td>Hidden layer dimensions</td>
</tr>
<tr>
<td><code>output_dim</code></td>
<td><code>int | tuple</code></td>
<td>No</td>
<td>Output dimensions</td>
</tr>
<tr>
<td><code>activation</code></td>
<td><code>str</code></td>
<td>No</td>
<td>Activation function</td>
</tr>
<tr>
<td><code>parameters</code></td>
<td><code>dict</code></td>
<td>No</td>
<td>Model-specific parameters</td>
</tr>
</tbody>
</table>
<h4 id="ddpm-parameters">DDPM Parameters<a class="headerlink" href="#ddpm-parameters" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>    <span class="s2">&quot;noise_steps&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>      <span class="c1"># Number of timesteps</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>    <span class="s2">&quot;beta_start&quot;</span><span class="p">:</span> <span class="mf">1e-4</span><span class="p">,</span>       <span class="c1"># Initial noise level</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    <span class="s2">&quot;beta_end&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>         <span class="c1"># Final noise level</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    <span class="s2">&quot;beta_schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span> <span class="c1"># Noise schedule</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="ddim-parameters">DDIM Parameters<a class="headerlink" href="#ddim-parameters" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>    <span class="s2">&quot;noise_steps&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>      <span class="c1"># Training steps</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>    <span class="s2">&quot;ddim_steps&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>         <span class="c1"># Sampling steps</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>    <span class="s2">&quot;eta&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>               <span class="c1"># Stochasticity</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>    <span class="s2">&quot;skip_type&quot;</span><span class="p">:</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>   <span class="c1"># Timestep selection</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>    <span class="s2">&quot;beta_start&quot;</span><span class="p">:</span> <span class="mf">1e-4</span><span class="p">,</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>    <span class="s2">&quot;beta_end&quot;</span><span class="p">:</span> <span class="mf">0.02</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="score-based-parameters">Score-Based Parameters<a class="headerlink" href="#score-based-parameters" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="p">{</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>    <span class="s2">&quot;sigma_min&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>        <span class="c1"># Minimum noise level</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>    <span class="s2">&quot;sigma_max&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>         <span class="c1"># Maximum noise level</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>    <span class="s2">&quot;score_scaling&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>     <span class="c1"># Score scaling factor</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>    <span class="s2">&quot;noise_steps&quot;</span><span class="p">:</span> <span class="mi">1000</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="latent-diffusion-parameters">Latent Diffusion Parameters<a class="headerlink" href="#latent-diffusion-parameters" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="p">{</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>    <span class="s2">&quot;latent_dim&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>                    <span class="c1"># Latent space dimension</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>    <span class="s2">&quot;encoder_hidden_dims&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span>    <span class="c1"># Encoder architecture</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>    <span class="s2">&quot;decoder_hidden_dims&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>    <span class="c1"># Decoder architecture</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>    <span class="s2">&quot;encoder_type&quot;</span><span class="p">:</span> <span class="s2">&quot;simple&quot;</span><span class="p">,</span>            <span class="c1"># Encoder type</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    <span class="s2">&quot;scale_factor&quot;</span><span class="p">:</span> <span class="mf">0.18215</span><span class="p">,</span>             <span class="c1"># Latent scaling</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>    <span class="s2">&quot;noise_steps&quot;</span><span class="p">:</span> <span class="mi">1000</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="dit-parameters">DiT Parameters<a class="headerlink" href="#dit-parameters" title="Permanent link">Â¤</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>    <span class="s2">&quot;img_size&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>           <span class="c1"># Image size</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>    <span class="s2">&quot;patch_size&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>          <span class="c1"># Patch size</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>    <span class="s2">&quot;hidden_size&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>       <span class="c1"># Transformer dimension</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>    <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>              <span class="c1"># Number of layers</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>    <span class="s2">&quot;num_heads&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>           <span class="c1"># Attention heads</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>    <span class="s2">&quot;mlp_ratio&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>         <span class="c1"># MLP expansion</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>    <span class="s2">&quot;num_classes&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>        <span class="c1"># Number of classes</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>    <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>      <span class="c1"># Dropout rate</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>    <span class="s2">&quot;learn_sigma&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>     <span class="c1"># Learn variance</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>    <span class="s2">&quot;cfg_scale&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>         <span class="c1"># Guidance scale</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>    <span class="s2">&quot;noise_steps&quot;</span><span class="p">:</span> <span class="mi">1000</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">Â¤</a></h2>
<h3 id="model-selection-guide">Model Selection Guide<a class="headerlink" href="#model-selection-guide" title="Permanent link">Â¤</a></h3>
<table>
<thead>
<tr>
<th>Model</th>
<th>Best For</th>
<th>Sampling Speed</th>
<th>Memory</th>
<th>Quality</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DDPMModel</strong></td>
<td>Standard use, learning</td>
<td>Slow (1000 steps)</td>
<td>High</td>
<td>â­â­â­â­â­</td>
</tr>
<tr>
<td><strong>DDIMModel</strong></td>
<td>Fast inference</td>
<td>Fast (50 steps)</td>
<td>High</td>
<td>â­â­â­â­</td>
</tr>
<tr>
<td><strong>ScoreDiffusionModel</strong></td>
<td>Research, flexibility</td>
<td>Medium</td>
<td>High</td>
<td>â­â­â­â­</td>
</tr>
<tr>
<td><strong>LDMModel</strong></td>
<td>High-res, efficiency</td>
<td>Fast</td>
<td>Medium</td>
<td>â­â­â­â­</td>
</tr>
<tr>
<td><strong>DiTModel</strong></td>
<td>Scalability, SOTA</td>
<td>Medium</td>
<td>Very High</td>
<td>â­â­â­â­â­</td>
</tr>
</tbody>
</table>
<h3 id="common-usage-patterns">Common Usage Patterns<a class="headerlink" href="#common-usage-patterns" title="Permanent link">Â¤</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1"># Basic DDPM</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DDPMModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="c1"># Fast DDIM</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DDIMModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ddim_sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="c1"># Latent Diffusion</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">LDMModel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="c1"># DiT with conditioning</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DiTModel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">cfg_scale</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">rngs</span><span class="o">=</span><span class="n">rngs</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">Â¤</a></h2>
<ul>
<li><a href="../../../user-guide/concepts/diffusion-explained/">Diffusion Concepts</a>: Theory and mathematical foundations</li>
<li><a href="../../../user-guide/models/diffusion-guide/">User Guide</a>: Practical usage examples</li>
<li><a href="../../../examples/basic/diffusion-mnist/">MNIST Tutorial</a>: Complete working example</li>
<li><a href="../../core/base/">Core API</a>: Base generative model classes</li>
<li><a href="../../core/configuration/">Configuration API</a>: Configuration system</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/avitai/artifex" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/artifex/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/mahdi_shafiei" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.path", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tracking", "toc.follow", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.tooltips", "content.mermaid"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>